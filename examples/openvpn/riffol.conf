init "openvpn" {
    application_groups = [
        "openvpn"
    ]
}

application_group "openvpn" {
    applications = [
        "nereond",
        "openvpn",
    ]
}

application "nereond" {
    exec = "nereond"
    env = {
        NEREON_FILESET = ${env:NEREON_FILESET}
    }
}

application "openvpn" {
    exec = "/riffol/openvpn-init.sh"
    dir = "/etc/openvpn"
    healthchecks : [
        "openvpn",
    ],
    healtcheckfail : "restart"
    stdout {
        filename "/var/log/openvpn-out"
    }
    stderr {
        filename "/var/log/openvpn-err"
    }
}

healthchecks "openvpn" {
    checks = [
        "proc://openvpn"
    ]
    timeout = 2
    interval = 10
}
